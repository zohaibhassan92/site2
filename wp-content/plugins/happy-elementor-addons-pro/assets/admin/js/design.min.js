!function(e,t){"use strict";var i=t.modules,n=i.controls.Select.extend({isSurpriseControl:function(){return"_ha_design"===this.model.get("name")&&-1!==this.getWidgetName().indexOf("ha-")},onReady:function(){window.happyDesigns=window.happyDesigns||{},this.fetchSurprises()},onRender:function(){this.constructor.__super__.onRender.apply(this,arguments),this.isSurpriseControl()&&this.addResetButton()},addResetButton:function(){var e=this;this.ui.select.before('<i title="Reset Style" class="eicon-redo ha-reset-design ha-reset-design--disable" aria-hidden="true"></i>'),this.$el.find(".ha-reset-design").on("click",function(){var i=t.getPanelView().getCurrentPageView().getOption("editedElementView");i&&i.resetStyle(),e.ui.select.val(""),e.setSettingsModel("")})},getWidgetName:function(){return this.elementSettingsModel.get("widgetType")},isFetched:function(){return!_.isUndefined(window.happyDesigns[this.getWidgetName()])},fetchSurprises:function(){var t=this;this.isSurpriseControl()&&!this.isFetched()&&this.getWidgetName()&&e.get(hapro.ajaxUrl,{action:"ha_make_me_surprised",widget:this.getWidgetName(),secret:hapro.secret}).done(function(e){e.success&&t.setSurprises(e.data)})},setSurprises:function(e){window.happyDesigns[this.getWidgetName()]=JSON.parse(e)},getSurprises:function(){return _.isUndefined(window.happyDesigns)?{}:window.happyDesigns[this.getWidgetName()]||{}},onBaseInputChange:function(e){if(this.constructor.__super__.onBaseInputChange.apply(this,arguments),this.isSurpriseControl()&&e.currentTarget.value){e.stopPropagation();var t=this.getSurprises();_.isUndefined(t[e.currentTarget.value])||this.applySurprise(t[e.currentTarget.value])}},applySurprise:function(e){var t=this.elementSettingsModel.controls,i=this,n={};_.each(t,function(t,s){if(i.model.get("name")!==s&&!_.isUndefined(e[s])){if(t.is_repeater){var r=i.elementSettingsModel.get(s).clone();r.each(function(t,n){_.isUndefined(e[s][n])||_.each(t.controls,function(t,o){i.isStyleTransferControl(t)&&r.at(n).set(o,e[s][n][o])})}),n[s]=r}i.isStyleTransferControl(t)&&(n[s]=e[s])}}),this.elementSettingsModel.set(n)},isStyleTransferControl:function(e){return!_.isUndefined(e.style_transfer)&&e.style_transfer?e.style_transfer:"content"!==e.tab||e.selectors||e.prefix_class}});t.addControlView("select",n)}(window.jQuery,window.elementor);