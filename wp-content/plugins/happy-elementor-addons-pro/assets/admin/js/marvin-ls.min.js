"use strict";window.XdUtils=window.XdUtils||function(){function e(e,n){var t,i=n||{};for(t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return i}return{extend:e}}(),window.xdLocalStorage=window.xdLocalStorage||function(){function e(e){u[e.id]&&(u[e.id](e),delete u[e.id])}function n(n){var t;try{t=JSON.parse(n.data)}catch(e){}t&&t.namespace===d&&("iframe-ready"===t.id?(f=!0,c.initCallback()):e(t))}function t(e,n,t,i){l++,u[l]=i;var a={namespace:d,id:l,action:e,key:n,value:t};r.contentWindow.postMessage(JSON.stringify(a),"*")}function i(e){c=XdUtils.extend(e,c);var t=document.createElement("div");window.addEventListener?window.addEventListener("message",n,!1):window.attachEvent("onmessage",n),t.innerHTML='<iframe id="'+c.iframeId+'" src='+c.iframeUrl+' style="display: none;"></iframe>',document.body.appendChild(t),r=document.getElementById(c.iframeId)}function a(){return s?!!f||(console.log("You must wait for iframe ready message before using the api."),!1):(console.log("You must call xdLocalStorage.init() before using it."),!1)}function o(){return"complete"===document.readyState}var r,d="cross-domain-local-message",c={iframeId:"cross-domain-iframe",iframeUrl:void 0,initCallback:function(){}},l=-1,u={},s=!1,f=!0;return{init:function(e){if(!e.iframeUrl)throw"You must specify iframeUrl";if(s)return void console.log("xdLocalStorage was already initialized!");s=!0,o()?i(e):document.addEventListener?document.addEventListener("readystatechange",function(){o()&&i(e)}):document.attachEvent("readystatechange",function(){o()&&i(e)})},setItem:function(e,n,i){a()&&t("set",e,n,i)},getItem:function(e,n){a()&&t("get",e,null,n)},removeItem:function(e,n){a()&&t("remove",e,null,n)},key:function(e,n){a()&&t("key",e,null,n)},getSize:function(e){a()&&t("size",null,null,e)},getLength:function(e){a()&&t("length",null,null,e)},clear:function(e){a()&&t("clear",null,null,e)},wasInit:function(){return s}}}();